# Лабораторная работа №5

## Тема: "Итераторы и аллокаторы"

### Цель:

- Изучение устройства коллекций в стандартной библиотеке
- Получение навыков в использовании концепции «итератор»
- Получение навыков в использовании концепции «аллокатор»

### Порядок выполнения работы
1) Ознакомиться с теоретическим материалом.
2) Получить у преподавателя вариант задания. (Вариант 17)
3) Реализовать задание своего варианта в соответствии с поставленными требованиями.
4) Подготовить тестовые наборы данных.
5) Создать репозиторий на GitHub.
6) Отправить файлы лабораторной работы в репозиторий.
7) Отчитаться по выполненной работе путём демонстрации работающей программы на тестовых наборах данных(как подготовленных самостоятельно, так и предложенных преподавателем) и ответов на вопросы преподавателя (как из числа контрольных, так и по реализации программы).

### Требования к программе
* Реализовать наследник std :: pmr :: memory_resource который реализует стратегию работы с памятью согласно варианта задания.
* memory_resource должен позволять периспользовать освобождаемую память (освобожденную ранее с помощью do_deallocate)
* memory_resource при уничтожении должен подчищать всю неосвобожденную ранее память
* Реализовать шаблонный контейнер согласно варианту задания, который использует созданный memory_resource через шаблон std :: pmr :: polymorphic_allocator.
* Реализовать итератор к созданному контейнеру. Итератор должен соответствовать std :: forward_iterator_tag.
* Создать код, демонстрирующий работ контейнера с простыми (int) и сложными типами (struct с несколькими полями)

Файлы:
- `include/memory_resource_reuse.hpp` — реализация `ReusingMemoryResource` (наследник `std::pmr::memory_resource`).
- `include/stack.hpp` — шаблонный стек `PmrStack<T>` с итератором (forward iterator).
- `src/main.cpp` — демонстрация работы со `int` и со сложным типом `Person`.
 - `tests/test_memory_resource.cpp`, `tests/test_stack.cpp` — юнит‑тесты (GoogleTest).

 ## Структура проекта

```
oop_laba_5_belyak_andrei/
├── include/
│   └── memory_resource_reuse.hpp    # Заголовочный файл с реализацией аллокатора
│   └── stack.hpp                    # Заголовочный файл с реализацией стека
├── src/
│   └── main.cpp         # Главная программа
│   └── CMakeLists.txt   # Cmake файл
├── test/                # Unit-тесты с использованием Google Test
│   └── test_memory_resource.cpp        
│   └── test_stack.cpp        
└── readme.md            # Данный файл
```

## Сборка и запуск проекта

**Сборка:**

```bash
# Конфигурация проекта
cmake ./src

# Сборка проекта
cmake --build .
```

**Запуск:**

```bash
./run
```

## Запуск тестов:

```bash
./pmr_stack_tests
```


Описание:
- Реализован ресурс, который хранит информацию о всех выделенных блоках в векторах.
- При `do_deallocate` блок не возвращается сразу в систему, а помещается в список свободных
  для последующего переиспользования.
- При разрушении `ReusingMemoryResource` освобождаются все блоки (и использующиеся, и свободные).
